<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>福岡九州之旅 2022</title>
    
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Font: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f4f4f5; /* Zinc 100 */
            -webkit-tap-highlight-color: transparent;
        }
        /* Hidden scrollbar for horizontal scrolling */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { 
            MapPin, Train, Utensils, Info, Calendar, 
            ExternalLink, Sun, Umbrella, Wallet, CheckSquare, 
            Plane, Home, Phone, ChevronRight, Navigation 
        } = lucide;

        // --- Data Extraction & Transformation from User CSVs ---
        
        const TRIP_DATA = {
            "2022-12-10": {
                city: "福岡市區",
                weatherCity: "Fukuoka",
                highlights: ["抵達", "天神", "屋台"],
                items: [
                    { time: "07:00", type: "transport", title: "抵達福岡機場", desc: "前往國內線航廈搭地鐵", sub: "建議購買地鐵一日券" },
                    { time: "08:30", type: "transport", title: "機場巴士/地鐵", desc: "搭1號巴士去國內線轉地鐵 (約15分)", dest: "天神南站" },
                    { time: "10:00", type: "hotel", title: "飯店寄放行李", desc: "住天神南，可在天神站走地下街到達" },
                    { time: "11:00", type: "visit", title: "天神地下街/市區", desc: "換電話卡，閒逛，吃午餐" },
                    { time: "18:00", type: "food", title: "中洲屋台", desc: "體驗博多屋台文化", tags: ["必吃", "氣氛"] }
                ]
            },
            "2022-12-11": {
                city: "別府",
                weatherCity: "Beppu",
                highlights: ["地獄溫泉", "米其林三星溫泉"],
                items: [
                    { time: "07:31", type: "transport", title: "音速號 Sonic", desc: "博多 -> 別府", dest: "別府站", sub: "09:52 抵達" },
                    { time: "10:30", type: "visit", title: "別府地獄巡禮", desc: "海地獄、血池地獄等7大溫泉", link: "https://boo2k.com" },
                    { time: "13:00", type: "food", title: "地獄蒸し工房 鉄輪", desc: "利用溫泉蒸氣蒸煮食物", tags: ["體驗", "特色"] },
                    { time: "15:00", type: "visit", title: "葫蘆溫泉", desc: "唯一米其林三星溫泉，砂浴體驗", sub: "記得帶毛巾", link: "https://hyotan-onsen.com" },
                    { time: "18:00", type: "food", title: "天丼 とよ常", desc: "別府人氣天丼", tags: ["排隊美食"] },
                    { time: "20:20", type: "transport", title: "音速號回程", desc: "別府 -> 博多", sub: "22:27 抵達" }
                ]
            },
            "2022-12-12": {
                city: "由布院",
                weatherCity: "Yufu",
                highlights: ["由布院之森", "金鱗湖", "釜飯"],
                items: [
                    { time: "09:17", type: "transport", title: "由布院之森 1號", desc: "博多 -> 由布院", dest: "由布院站", sub: "11:31 抵達 (需劃位)" },
                    { time: "12:00", type: "food", title: "由布まぶし心 (駅前店)", desc: "地雞、鰻魚、豐後牛蓋飯三吃", tags: ["必吃", "排隊"], link: "https://www.bigfang.tw/blog/post/yufumabushishin" },
                    { time: "13:30", type: "visit", title: "湯之坪街道", desc: "B-Speak 蛋糕捲, 史努比茶屋" },
                    { time: "14:30", type: "visit", title: "Yufuin Floral Village", desc: "童話村、貓頭鷹之森", link: "http://floral-village.com/" },
                    { time: "15:30", type: "visit", title: "金鱗湖", desc: "晨霧與倒影最美，但下午也很愜意" },
                    { time: "19:26", type: "transport", title: "由布院號回程", desc: "由布院 -> 博多", sub: "21:33 抵達" }
                ]
            },
            "2022-12-13": {
                city: "熊本",
                weatherCity: "Kumamoto",
                highlights: ["熊本熊", "勝烈亭", "熊本城"],
                items: [
                    { time: "08:30", type: "transport", title: "新幹線 櫻花號", desc: "博多 -> 熊本", dest: "熊本站", sub: "09:00 抵達 (超快!)" },
                    { time: "09:30", type: "visit", title: "熊本站買一日券", desc: "市電一日券 500yen", sub: "綜合觀光案內所" },
                    { time: "10:30", type: "visit", title: "熊本熊部長辦公室", desc: "鶴屋百貨東館 1F", tags: ["親子", "拍照"] },
                    { time: "12:00", type: "food", title: "勝烈亭 豬排", desc: "米其林推薦，鹿兒島六白黑豬", tags: ["米其林", "必吃"] },
                    { time: "14:00", type: "visit", title: "熊本城 & 加藤神社", desc: "日本三大名城之一，修復中見學" },
                    { time: "16:00", type: "visit", title: "櫻之馬場 城彩苑", desc: "江戶時代風情商店街，吃海膽可樂餅" },
                    { time: "18:00", type: "food", title: "菅乃屋 馬肉料理", desc: "熊本特色生馬肉 (可選)", tags: ["挑戰"] },
                    { time: "21:10", type: "transport", title: "新幹線回程", desc: "熊本 -> 博多", sub: "21:48 抵達" }
                ]
            },
            "2022-12-14": {
                city: "鹿兒島",
                weatherCity: "Kagoshima",
                highlights: ["櫻島火山", "仙巖園", "黑豚"],
                items: [
                    { time: "07:58", type: "transport", title: "新幹線 瑞穗號", desc: "博多 -> 鹿兒島中央", dest: "鹿兒島中央", sub: "09:33 抵達" },
                    { time: "10:00", type: "transport", title: "櫻島渡輪", desc: "前往櫻島火山", sub: "船上必吃烏龍麵" },
                    { time: "10:30", type: "visit", title: "櫻島", desc: "有村熔岩展望台、叫叫廣塲泡足湯" },
                    { time: "13:00", type: "food", title: "黑豚料理 壽庵", desc: "黑豚涮涮鍋/炸豬排", tags: ["名物"] },
                    { time: "15:00", type: "visit", title: "仙巖園", desc: "借景櫻島的日式庭園，吃兩棒餅", tags: ["世界遺產"] },
                    { time: "18:00", type: "visit", title: "天文館通", desc: "鹿兒島最熱鬧商店街，白熊冰" },
                    { time: "20:59", type: "transport", title: "新幹線回程", desc: "鹿兒島中央 -> 博多", sub: "22:44 抵達" }
                ]
            },
            "2022-12-15": {
                city: "能古島/太宰府",
                weatherCity: "Fukuoka",
                highlights: ["海島公園", "太宰府天滿宮"],
                items: [
                    { time: "09:00", type: "transport", title: "渡輪往能古島", desc: "姪濱渡船場出發", dest: "能古島" },
                    { time: "10:00", type: "visit", title: "能古島海島公園", desc: "四季花海，海景盪鞦韆", link: "http://nokonoshima.com/" },
                    { time: "13:00", type: "transport", title: "前往太宰府", desc: "回市區轉西鐵電車" },
                    { time: "14:30", type: "visit", title: "太宰府天滿宮", desc: "學問之神，表參道吃梅枝餅", tags: ["必吃梅枝餅"] },
                    { time: "16:00", type: "visit", title: "星巴克 太宰府店", desc: "隈研吾設計，木條交錯建築", tags: ["打卡"] },
                    { time: "18:00", type: "food", title: "一蘭拉麵 太宰府參道店", desc: "限定五角碗 (合格祈願)", tags: ["限定"] }
                ]
            },
            "2022-12-16": {
                city: "長崎",
                weatherCity: "Nagasaki",
                highlights: ["原爆館", "千萬夜景", "土耳其飯"],
                items: [
                    { time: "08:10", type: "transport", title: "接力海鷗號", desc: "博多 -> 武雄溫泉轉新幹線 -> 長崎", dest: "長崎站", sub: "09:50 抵達" },
                    { time: "10:30", type: "visit", title: "長崎原爆資料館", desc: "平和公園，沉重的歷史" },
                    { time: "12:30", type: "food", title: "Tsuruchan 鶴茶庵", desc: "長崎名物：土耳其飯", tags: ["老舖"], link: "https://bring-you.info/nagasaki-tsuru-chan" },
                    { time: "14:00", type: "visit", title: "哥拉巴園", desc: "蝴蝶夫人故居，異國風情，尋找愛心石" },
                    { time: "16:00", type: "visit", title: "大浦天主堂", desc: "日本最古老教堂" },
                    { time: "17:30", type: "visit", title: "稻佐山夜景", desc: "世界新三大夜景，搭纜車上山", tags: ["必看"] },
                    { time: "19:30", type: "food", title: "吉宗", desc: "元祖茶碗蒸，整套桌袱料理", tags: ["必吃"] },
                    { time: "20:20", type: "transport", title: "新幹線回程", desc: "長崎 -> 博多", sub: "21:56 抵達" }
                ]
            },
            "2022-12-17": {
                city: "福岡/返程",
                weatherCity: "Fukuoka",
                highlights: ["購物", "回程"],
                items: [
                    { time: "09:00", type: "hotel", title: "Check-out", desc: "行李寄放博多車站 Locker" },
                    { time: "10:00", type: "visit", title: "博多車站/運河城", desc: "最後衝刺購物，買伴手禮" },
                    { time: "12:00", type: "food", title: "博多拉麵", desc: "博多一雙 或 ShinShin", tags: ["最後一碗"] },
                    { time: "14:00", type: "transport", title: "前往機場", desc: "地鐵往福岡機場" },
                    { time: "15:00", type: "plane", title: "辦理登機", desc: "填寫回程健康申報", sub: "Bye Bye Kyushu" }
                ]
            }
        };

        const PRE_TRIP_LIST = [
            { id: 1, text: "護照 (檢查效期)", checked: true },
            { id: 2, text: "Visit Japan Web 登錄", checked: true },
            { id: 3, text: "3針疫苗證明 / PCR", checked: true },
            { id: 4, text: "外幣兌換 (約40萬日幣)", checked: true },
            { id: 5, text: "網卡/漫遊開通", checked: false },
            { id: 6, text: "行動電源 (Handcarry)", checked: true },
            { id: 7, text: "個人藥品/快篩", checked: false },
            { id: 8, text: "購買 JR Pass", checked: true }
        ];

        const BUDGET_DATA = {
            totalYen: 429000,
            spentYen: 0,
            categories: [
                { name: "JR Pass (已付)", amount: 36000, color: "bg-green-500" },
                { name: "住宿 (已付)", amount: 80000, color: "bg-blue-500" },
                { name: "餐飲預估", amount: 150000, color: "bg-orange-500" },
                { name: "購物/雜支", amount: 163000, color: "bg-pink-500" },
            ]
        };

        // --- Helper Components ---

        const NavButton = ({ to, label, primary = false }) => (
            <a 
                href={to} 
                target="_blank" 
                rel="noreferrer"
                className={`flex items-center justify-center gap-1 px-3 py-1.5 rounded-full text-xs font-medium transition-all ${
                    primary 
                    ? "bg-indigo-600 text-white shadow-md hover:bg-indigo-700" 
                    : "bg-white text-gray-600 border border-gray-200 shadow-sm hover:bg-gray-50"
                }`}
            >
                {primary ? <Navigation size={12} /> : <ExternalLink size={12} />}
                {label}
            </a>
        );

        const Tag = ({ text }) => {
            let colorClass = "bg-gray-100 text-gray-600";
            if (text.includes("必") || text.includes("米其林")) colorClass = "bg-red-100 text-red-600 font-bold";
            if (text.includes("限定") || text.includes("名物")) colorClass = "bg-amber-100 text-amber-700";
            
            return (
                <span className={`px-2 py-0.5 rounded text-[10px] ${colorClass}`}>
                    #{text}
                </span>
            );
        };

        // --- Main Views ---

        const ItineraryView = ({ selectedDate, onDateChange }) => {
            const data = TRIP_DATA[selectedDate];
            const dates = Object.keys(TRIP_DATA);

            const getTypeIcon = (type) => {
                switch (type) {
                    case 'transport': return <Train className="text-indigo-500" size={20} />;
                    case 'food': return <Utensils className="text-orange-500" size={20} />;
                    case 'visit': return <MapPin className="text-emerald-500" size={20} />;
                    case 'hotel': return <Home className="text-blue-500" size={20} />;
                    case 'plane': return <Plane className="text-sky-500" size={20} />;
                    default: return <Info className="text-gray-400" size={20} />;
                }
            };

            return (
                <div className="pb-24">
                    {/* Date Selector */}
                    <div className="sticky top-0 z-20 bg-white/95 backdrop-blur-sm border-b border-gray-100 shadow-sm">
                        <div className="flex overflow-x-auto hide-scrollbar p-4 gap-3">
                            {dates.map(date => {
                                const dayNum = date.split('-')[2];
                                const isActive = date === selectedDate;
                                return (
                                    <button 
                                        key={date}
                                        onClick={() => onDateChange(date)}
                                        className={`flex flex-col items-center min-w-[3.5rem] p-2 rounded-xl transition-all ${
                                            isActive 
                                            ? "bg-indigo-600 text-white shadow-lg scale-105" 
                                            : "bg-white text-gray-400 border border-gray-100"
                                        }`}
                                    >
                                        <span className="text-xs font-medium uppercase">{new Date(date).toLocaleDateString('en-US', {weekday: 'short'})}</span>
                                        <span className="text-xl font-bold">{dayNum}</span>
                                    </button>
                                )
                            })}
                        </div>
                    </div>

                    {/* Daily Header */}
                    <div className="px-6 py-6">
                        <div className="flex justify-between items-start">
                            <div>
                                <h1 className="text-3xl font-bold text-gray-800 tracking-tight">{data.city}</h1>
                                <p className="text-gray-500 mt-1 text-sm flex gap-2">
                                    {data.highlights.map(h => <span key={h} className="text-indigo-500 font-medium">✦ {h}</span>)}
                                </p>
                            </div>
                            <a 
                                href={`https://weather.yahoo.co.jp/weather/search/?a=&p=${data.weatherCity}`} 
                                target="_blank"
                                className="flex flex-col items-center bg-blue-50 p-2 rounded-lg"
                            >
                                <Sun className="text-orange-400 mb-1" size={20} />
                                <span className="text-[10px] text-blue-600 font-bold">天氣</span>
                            </a>
                        </div>
                    </div>

                    {/* Timeline Cards */}
                    <div className="px-4 flex flex-col gap-4 relative">
                        <div className="absolute left-8 top-4 bottom-4 w-0.5 bg-gray-200 -z-10"></div>
                        
                        {data.items.map((item, idx) => (
                            <div key={idx} className="flex gap-4 items-start">
                                {/* Time Column */}
                                <div className="flex flex-col items-center min-w-[3.5rem] pt-1 bg-f4f4f5">
                                    <span className="text-sm font-bold text-gray-600 font-mono bg-[#f4f4f5] py-1">{item.time}</span>
                                </div>
                                
                                {/* Card */}
                                <div className="flex-1 glass-card p-4 rounded-2xl shadow-[0_4px_20px_-10px_rgba(0,0,0,0.1)] transition-transform active:scale-[0.98]">
                                    <div className="flex justify-between items-start mb-2">
                                        <div className="flex gap-2 items-center">
                                            <div className="p-1.5 bg-gray-50 rounded-lg">
                                                {getTypeIcon(item.type)}
                                            </div>
                                            <h3 className={`font-bold text-gray-800 ${item.type === 'transport' ? 'text-indigo-900' : ''}`}>
                                                {item.title}
                                            </h3>
                                        </div>
                                    </div>

                                    <p className="text-sm text-gray-600 leading-relaxed mb-3">
                                        {item.desc}
                                    </p>

                                    {item.dest && (
                                        <div className="flex items-center gap-1 text-xs text-gray-500 mb-3 bg-gray-50 p-2 rounded border border-gray-100">
                                            <Navigation size={12} /> 目的地: {item.dest}
                                        </div>
                                    )}

                                    {item.sub && (
                                        <div className="text-xs text-indigo-500 font-medium mb-3">
                                            ℹ️ {item.sub}
                                        </div>
                                    )}

                                    <div className="flex flex-wrap gap-2 mt-2 items-center justify-between border-t border-gray-100 pt-3">
                                        <div className="flex gap-1 flex-wrap">
                                            {item.tags && item.tags.map(t => <Tag key={t} text={t} />)}
                                        </div>
                                        
                                        <div className="flex gap-2">
                                            {item.link && <NavButton to={item.link} label="資訊" />}
                                            <NavButton 
                                                to={`https://www.google.com/maps/search/?api=1&query=${item.dest || item.title}+${data.city}`} 
                                                label="導航" 
                                                primary 
                                            />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const ToolsView = () => {
            const [checklist, setChecklist] = useState(PRE_TRIP_LIST);

            const toggleCheck = (id) => {
                setChecklist(prev => prev.map(item => 
                    item.id === id ? { ...item, checked: !item.checked } : item
                ));
            };

            return (
                <div className="p-6 pb-24">
                    <h1 className="text-2xl font-bold text-gray-800 mb-6">旅行工具箱</h1>

                    {/* Emergency Card */}
                    <div className="bg-red-50 p-4 rounded-2xl border border-red-100 mb-6 flex gap-4 items-center">
                        <div className="bg-red-100 p-3 rounded-full text-red-600">
                            <Phone size={24} />
                        </div>
                        <div>
                            <h3 className="font-bold text-red-800">緊急聯絡</h3>
                            <p className="text-xs text-red-600">日本報警 110 | 救護車 119</p>
                            <p className="text-xs text-red-600 mt-1">外交部緊急: 080-3524-7662</p>
                        </div>
                    </div>

                    {/* Budget Section */}
     